# Blueprint: 自助繳費機

## 專案概述

這是一個為台安醫院設計的自助繳費機前端應用程式。使用者可以透過掃描條碼或插入健保卡的方式，查詢並繳納醫療費用。應用程式以 Vue.js 和 Vite 建置，注重使用者體驗和介面設計的現代感與直覺性。

---

## 功能與設計藍圖

### 核心功能

*   **多樣的登入方式**: 支援掃描條碼或插入健保卡，方便不同使用者操作。
*   **清晰的繳費流程**: 從讀取資料、顯示費用明細、完成繳費到列印收據，每一步都有明確的引導和視覺回饋。
*   **高仿真收據列印**: 付款後，使用者可以選擇列印一張仿照真實醫療收據設計的 A5 橫向收據，包含所有費用明細和一個模擬的紅色戳章。
*   **互動式倒數計時器**: 在關鍵頁面設有自動返回首頁的倒數計時器，且使用者在頁面上的任何互動都會重置計時，提供更友善的操作緩衝時間。
*   **統一的視覺風格**: 整體介面採用現代化的設計，背景圖片、色彩搭配和動畫效果都經過精心設計，提升了應用的專業感和使用者體驗。

### 頁面流程與元件

1.  **歡迎頁面 (`WelcomePage.vue`)**: 
    *   **設計**: 氣派的醫院背景圖，搭配置中的歡迎訊息和「開啟程式」按鈕。
    *   **功能**: 點擊按鈕後，會顯示進度條，模擬系統啟動過程，完成後自動跳轉至主選單。

2.  **主選單 (`KioskPage.vue`)**:
    *   **設計**: 提供「掃描條碼」和「插入健保卡」兩個主要操作選項。
    *   **功能**: 引導使用者選擇接下來的操作。

3.  **掃描/插卡流程**:
    *   `ScanBarcodePage.vue`: 引導使用者掃描病歷號條碼。頁面載入時會自動播放語音提示。
    *   `InsertCardPage.vue`: 引導使用者插入健保卡。頁面載入時會自動播放語音提示。
    *   `ReadingCardPage.vue`: 顯示正在讀取資料的動畫。
    *   `CardProcessedPage.vue`: 顯示資料處理中的提示，並播放語音。設有 30 秒倒數返回首頁功能。

4.  **費用與付款 (`PaymentDetailsPage.vue`)**:
    *   **設計**: 顯示詳細的費用項目與總金額，並提供現金或信用卡的繳費方式選擇。右上角有 120 秒的倒數計時器。
    *   **功能**: 處理付款相關的邏輯。在使用者確認付款後，會顯示短暫的處理提示，然後將完整的付款資料和付款方式傳遞並導向至 `PaymentReceivedPage.vue`。
    *   **互動**: 使用者在頁面上的任何點擊都會將 120 秒的倒數計時器重置。

5.  **付款成功與收據列印 (`PaymentReceivedPage.vue`)**:
    *   **設計**: 在頁面中央顯示一個「付款成功」的動畫和訊息，下方提供「回到首頁」和「列印收據」兩個按鈕。同時，頁面中包含一個在正常瀏覽時隱藏的、專為列印設計的高仿真收據版面。
    *   **功能**:
        *   **回到首頁**: 點擊後導航至 `KioskPage.vue`。
        *   **列印收據**: 點擊後觸發瀏覽器的 `window.print()` 功能。透過 `@media print` CSS 規則，只列印隱藏的收據部分，實現所見即所得的列印效果。
        *   **資料接收**: 頁面會從 `PaymentDetailsPage.vue` 接收傳遞過來的付款明細和付款方式，並將其填充到隱藏的收據中。

### 路由設定 (`router.js`)

使用 `vue-router` 管理所有頁面間的跳轉邏輯，並透過 `beforeEach` 導航守衛來清理計時器，確保流程順暢且穩定。

---

## 最近的修改計畫

### 1. 修正倒數計時器並新增互動功能

*   **目標**: 修正 `PaymentDetailsPage.vue` 的倒數計時器樣式，並新增點擊重置功能。
*   **步驟**:
    *   將 `CardProcessedPage.vue` 的倒數計時器 CSS 樣式應用到 `PaymentDetailsPage.vue`。
    *   在 `PaymentDetailsPage.vue` 中加入全域點擊事件監聽器，當使用者點擊頁面時，重置 120 秒的倒數計時器。
    *   確保在元件卸載或付款處理中移除監聽器，以避免不必要的行為。

### 2. 移除多餘的語音錯誤處理程式碼

*   **目標**: 清理專案程式碼，移除不再需要的語音載入失敗錯誤處理邏輯。
*   **步驟**:
    *   **`InsertCardPage.vue`**: 移除了 `onMounted` hook 中的 `.catch()` 和 `addEventListener('error', ...)` 程式碼。
    *   **`CardProcessedPage.vue`**: 同樣移除了 `onMounted` hook 中的語音錯誤處理程式碼。
    *   **`ScanBarcodePage.vue`**: 同樣移除了 `onMounted` hook 中的語音錯誤處理程式碼。
*   **結果**: 讓相關元件的程式碼更加簡潔。
